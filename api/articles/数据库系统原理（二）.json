{"title":"数据库系统原理（二）","uid":"77e095561161043d7bcb5f0fd932479f","slug":"数据库系统原理（二）","date":"2023-03-29T08:37:00.000Z","updated":"2023-04-06T07:24:25.739Z","comments":true,"path":"api/articles/数据库系统原理（二）.json","keywords":"C++,Pyhton,Java,算法","cover":"/img/db.jpeg","content":"<h2 id=\"数据的定义与操作\"><a href=\"#数据的定义与操作\" class=\"headerlink\" title=\"数据的定义与操作\"></a>数据的定义与操作</h2><h3 id=\"SQL概述\"><a href=\"#SQL概述\" class=\"headerlink\" title=\"SQL概述\"></a>SQL概述</h3><p>关系数据库的标准语言是 Structured Query Language，全称的翻译成中文就是结构化查询语言，简称SQL。虽然SQL字面含义是“查询语言”，但是其功能却包括了数据定义、数据查询、数据修改和保护等许多内容。伴随着数据库技术的发展和应用，国际标准化组织先后发布了SQL语言的多个版本的标准。实际中，各种不同数据库管理系统 在SQL语言的实现上存在一些小的差异。</p>\n<p>SQL语言的核心是SELECT语句，基本Select语句的一般形式中，第一个子句是SELECT，SELECT后面是ALL或者DISTINCT，或ALL和DISTINCT两个都不出现的默认的声明，再后面是一个或多个&lt;目标列表达式&gt;，每个&lt; 目标列表达式 &gt;还可以起个[ 别名 ]跟在后面；第二个子句是FROM FROM后面可以是一个&lt; 表名 &gt;或者是一个[&lt; 连接表达式 &gt;]；第三个子句是WHERE，WHERE后面是一个&lt; 条件表达式 &gt;；第四个子句是GROUP BY，GROUP BY后面是一个或多个 &lt; 列名 &gt; ；第五个子句是HAVING，HAVING后面是一个&lt; 条件表达式 &gt;；第六个子句是ORDER BY，ORDER BY后面是一个或多个 &lt; 列名 &gt; 以及相应的ASC或DESC，或两者都不出现的默认声明。ASC表示按升序排列，DESC表示按降序排列。如果指定了多个排序列，那么仅在前面的表达式排序相等的情况下，才使用后面的表达式做进一步排序；第七个子句是LIMIT，后面是一个表示输出行数的数值，再后面是offset 后面跟一个表示偏移量的数值，这就是基本Select语句的一般形式。</p>\n<div class=\"language-sql\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">sql</span><pre class=\"shiki dark-plus\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #569CD6\">SELECT</span><span style=\"color: #D4D4D4\"> [ALL|DISTINCT]</span></span>\n<span class=\"line\"><span style=\"color: #D4D4D4\">    &lt;目标列表达式&gt; [别名][,&lt;目标列表达式&gt; [别名]]...</span></span>\n<span class=\"line\"><span style=\"color: #D4D4D4\">[FROM &lt;表名&gt;[别名] [&lt;连接表达式&gt;]...]</span></span>\n<span class=\"line\"><span style=\"color: #D4D4D4\">[WHERE &lt;条件表达式&gt;]</span></span>\n<span class=\"line\"><span style=\"color: #D4D4D4\">[GROUP BY &lt;列名&gt; [&lt;列名&gt;]</span></span>\n<span class=\"line\"><span style=\"color: #D4D4D4\">[HAVING &lt;条件表达式&gt;]]</span></span>\n<span class=\"line\"><span style=\"color: #D4D4D4\">[ORDER BY &lt;列名&gt; [ASC|DESC] [&lt;列名&gt; [ASC|DESC]]</span></span>\n<span class=\"line\"><span style=\"color: #D4D4D4\">[LIMIT &lt;行数&gt; [&lt;OFFSET偏移量&gt;]]];</span></span></code></pre></div><p>整个语句的执行过程:（在实际执行时数据库管理系统会为了尽可能快地获得等价查询结果而采取完全不同的执行步骤<br>）</p>\n<ol>\n<li>如果仅有SELECT子句，按SELECT子句中给出的列名或列表达式求值，否则继续执行(2) ;</li>\n<li>FROM: 从FROM子句获得表;</li>\n<li>取满足WHERE子句所给出条件表达式的行;</li>\n<li>按GROUP BY子句中指定列的值分组;</li>\n<li>提取满足HAVING子句中组条件表达式的那些组;</li>\n<li>按SELECT子句中给出的列名或列表达式求值;</li>\n<li>ORDER BY子句对输出的目标表进行排序，ASC:升序，DESC:降序;</li>\n<li>按照LIMIT子句的偏移量和行数确定输出元组;</li>\n</ol>\n<p><strong>WHERE与HAVING的区别</strong>：WHERE子句是作用于FROM子句中关系的属性上的谓词，从FROM子句结果关系中选择满足条件的行，WHERE子句必须跟在FROM子句后面，没FROM子句就不能有WHERE子句;HAVING子句作用于GROUP BY子句的结果组，从中选择满足条件的组，HAVING子句必须跟在GROUP BY子句后面，没有GROUP BY子句就不能有HAVING子句。</p>\n<p>SQL语言是大小写不敏感的，PG建议SQL的保留字用大写 表名，字段名等所有数据库对象名全部使用小写，除非从定义到使用始终都加双引号，否则系统把所有对象名自动转化为小写，PG用单引号做字符串常量的标识，只有引号里面的字符才区分大小写。</p>\n<h3 id=\"数据的定义以及修改\"><a href=\"#数据的定义以及修改\" class=\"headerlink\" title=\"数据的定义以及修改\"></a>数据的定义以及修改</h3><p><strong>表的定义</strong>包括表模式的创建、修改和删除</p>\n<p><strong>数据修改</strong>包括给表里添加数据、更新数据以及删除数据</p>\n<p><strong>创建表</strong>：</p>\n<div class=\"language-sql\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">sql</span><pre class=\"shiki dark-plus\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #569CD6\">CREATE</span><span style=\"color: #D4D4D4\"> </span><span style=\"color: #569CD6\">TABLE</span><span style=\"color: #D4D4D4\">&lt;表名&gt;</span></span>\n<span class=\"line\"><span style=\"color: #D4D4D4\">  (&lt;列名&gt;&lt;数据类型&gt;,</span></span>\n<span class=\"line\"><span style=\"color: #D4D4D4\">  &lt;列名&gt;&lt;数据类型&gt;,</span></span>\n<span class=\"line\"><span style=\"color: #D4D4D4\">  ...</span></span>\n<span class=\"line\"><span style=\"color: #D4D4D4\">  );</span></span></code></pre></div><p>可以看到表的每个列都要指定数据类型，具体数据类型<a href=\"https://www.w3school.com.cn/sql/sql_datatypes.asp\">查看此表</a></p>\n<p><strong>更改表的名字</strong>：</p>\n<div class=\"language-sql\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">sql</span><pre class=\"shiki dark-plus\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #569CD6\">ALTER</span><span style=\"color: #D4D4D4\"> </span><span style=\"color: #569CD6\">TABLE</span><span style=\"color: #D4D4D4\"> &lt;表名&gt; RENAME </span><span style=\"color: #569CD6\">TO</span><span style=\"color: #D4D4D4\"> &lt;新表名&gt;;</span></span></code></pre></div><p><strong>删除表</strong>：</p>\n<div class=\"language-sql\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">sql</span><pre class=\"shiki dark-plus\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #569CD6\">DROP</span><span style=\"color: #D4D4D4\"> </span><span style=\"color: #569CD6\">TABLE</span><span style=\"color: #D4D4D4\"> &lt;表名&gt;</span></span></code></pre></div><p><strong>修改表</strong>：</p>\n<div class=\"language-sql\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">sql</span><pre class=\"shiki dark-plus\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #569CD6\">ALTER</span><span style=\"color: #D4D4D4\"> </span><span style=\"color: #569CD6\">TABLE</span><span style=\"color: #D4D4D4\">&lt;表名&gt;</span></span>\n<span class=\"line\"><span style=\"color: #D4D4D4\">[ADD COLUMN &lt;新列名&gt; &lt;数据类型&gt;]</span></span>\n<span class=\"line\"><span style=\"color: #D4D4D4\">[ADD [完整性约束(&lt;列名&gt;)] ]</span></span>\n<span class=\"line\"><span style=\"color: #D4D4D4\">[RENAME COLUMN &lt;旧列名&gt; TO &lt;新列名&gt;]</span></span>\n<span class=\"line\"><span style=\"color: #D4D4D4\">[ALTER COLUMN &lt;列名&gt; TYPE &lt;数据类型&gt;]</span></span>\n<span class=\"line\"><span style=\"color: #D4D4D4\">[DROP COLUMN &lt;列名&gt;];</span></span></code></pre></div><p><strong>插入元组</strong>：<br>插入元组的分量个数必须是正确的，插入元组的属性值必须在属性域中，元组值对应的属性排列顺序必须与定义时的顺序一致，否则必须在INSERT语句中明确指明属性顺序。在插入的常量元组中非主键属性可以使用空值null。</p>\n<div class=\"language-sql\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">sql</span><pre class=\"shiki dark-plus\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #569CD6\">INSERT INTO</span><span style=\"color: #D4D4D4\"> &lt;表名&gt; [(&lt;属性1&gt;[,&lt;属性2&gt;,...])]</span><span style=\"color: #569CD6\">VALUES</span><span style=\"color: #D4D4D4\"> (&lt;常量1&gt;[,&lt;常量2&gt;]... )</span></span></code></pre></div><p><strong>插入查询结果</strong>：</p>\n<div class=\"language-sql\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">sql</span><pre class=\"shiki dark-plus\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #569CD6\">INSERT INTO</span><span style=\"color: #D4D4D4\"> &lt;表名&gt; [(&lt;列名序列&gt;)]</span></span>\n<span class=\"line\"><span style=\"color: #D4D4D4\">&lt;SELECT查询语句&gt;</span></span></code></pre></div><p><strong>插入表</strong>：</p>\n<div class=\"language-sql\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">sql</span><pre class=\"shiki dark-plus\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #569CD6\">INSERT INTO</span><span style=\"color: #D4D4D4\"> &lt;表名1&gt; [(&lt;列名序列&gt;)]</span></span>\n<span class=\"line\"><span style=\"color: #569CD6\">TABLE</span><span style=\"color: #D4D4D4\"> &lt;表名2&gt;</span></span></code></pre></div><p><strong>删除元组</strong>：<br>如果没有任何条件限制，将删除所有元组</p>\n<div class=\"language-sql\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">sql</span><pre class=\"shiki dark-plus\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #569CD6\">DELETE</span><span style=\"color: #D4D4D4\"> </span><span style=\"color: #569CD6\">FROM</span><span style=\"color: #D4D4D4\"> &lt;表名&gt; [WHERE &lt;条件表达式&gt;]</span></span></code></pre></div><p><strong>更新表中元组的某些列值</strong>：<br>如果没有任何条件限制，将更新所有元组</p>\n<div class=\"language-sql\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">sql</span><pre class=\"shiki dark-plus\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #569CD6\">UPDATE</span><span style=\"color: #D4D4D4\"> &lt;表名&gt;</span></span>\n<span class=\"line\"><span style=\"color: #569CD6\">SET</span><span style=\"color: #D4D4D4\"> &lt;列名&gt;=&lt;表达式&gt;[,&lt;列名&gt;=&lt;表达式&gt;]...</span></span>\n<span class=\"line\"><span style=\"color: #D4D4D4\">[WHERE &lt;条件&gt;]</span></span></code></pre></div><h3 id=\"简单查询\"><a href=\"#简单查询\" class=\"headerlink\" title=\"简单查询\"></a>简单查询</h3><p><em>单表查询：包括投影、选择和聚集查询。</em></p>\n<p>投影查询包括基本投影和广义投影，基本投影是指选取表中的某些列的列值；广义投影是指在选取属性列时，允许进行一些适当的运算。<br>例如，从student表中查找全部的学生id以及学生名字，输出每一行的id以及stu_name：</p>\n<div class=\"language-sql\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">sql</span><pre class=\"shiki dark-plus\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #569CD6\">SELECT</span><span style=\"color: #D4D4D4\"> id , stu_name</span></span>\n<span class=\"line\"><span style=\"color: #569CD6\">FROM</span><span style=\"color: #D4D4D4\"> student</span></span></code></pre></div><p>一般可以用*号代表全部列。</p>\n<div class=\"language-sql\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">sql</span><pre class=\"shiki dark-plus\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #569CD6\">SELECT</span><span style=\"color: #D4D4D4\"> *</span></span>\n<span class=\"line\"><span style=\"color: #569CD6\">FROM</span><span style=\"color: #D4D4D4\"> student</span></span></code></pre></div><p>广义投影（SELECT后面跟表达式）：查询所有id以及与100分的差值</p>\n<div class=\"language-sql\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">sql</span><pre class=\"shiki dark-plus\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #569CD6\">SELECT</span><span style=\"color: #D4D4D4\"> id,</span><span style=\"color: #B5CEA8\">100</span><span style=\"color: #D4D4D4\">-grade</span></span>\n<span class=\"line\"><span style=\"color: #569CD6\">FROM</span><span style=\"color: #D4D4D4\"> student</span></span></code></pre></div><p>用ORDER BY对结果进行排序，查询全体学生，按成绩升序，按年龄降序。</p>\n<div class=\"language-sql\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">sql</span><pre class=\"shiki dark-plus\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #569CD6\">SELECT</span><span style=\"color: #D4D4D4\"> *</span></span>\n<span class=\"line\"><span style=\"color: #569CD6\">FROM</span><span style=\"color: #D4D4D4\"> student</span></span>\n<span class=\"line\"><span style=\"color: #569CD6\">ORDER BY</span><span style=\"color: #D4D4D4\"> grade </span><span style=\"color: #569CD6\">ASC</span><span style=\"color: #D4D4D4\">,age </span><span style=\"color: #569CD6\">DESC</span></span></code></pre></div><p>投影结果中可能出现所有列值均相等的重复行，但从数据库<br>管理系统实现的角度看，投影过程会对每个新产生的结果行进行标识，即系统能区分每个行，也就是说，由于去重是一项耗时的工作，DBMS采取惰性原则:除非在SELECT后跟DISTINCT明确指出要求去重，否则，默认情况下、或者SELECT后跟ALL时都保留重复。</p>\n<p><strong>选择查询：</strong>选择所有年龄大于20的学生的行</p>\n<div class=\"language-sql\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">sql</span><pre class=\"shiki dark-plus\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #569CD6\">SELECT</span><span style=\"color: #D4D4D4\"> *</span></span>\n<span class=\"line\"><span style=\"color: #569CD6\">FROM</span><span style=\"color: #D4D4D4\"> student</span></span>\n<span class=\"line\"><span style=\"color: #569CD6\">WHERE</span><span style=\"color: #D4D4D4\"> age&gt;</span><span style=\"color: #B5CEA8\">20</span><span style=\"color: #D4D4D4\">;</span></span></code></pre></div><p><em>数据库用于选择查询的的关系运算符：</em><br><img src=\"/img/数据库关系运算.png\"></p>\n<p><strong>聚集查询</strong>：从多个输入行中计算出一个结果。如sum等。还可以使用GROUP BY使得所有给出列上取值相同的行被分在一个组，将聚集函数作用在组上。</p>\n<div class=\"language-sql\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">sql</span><pre class=\"shiki dark-plus\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #569CD6\">SELECT</span><span style=\"color: #D4D4D4\"> department, </span><span style=\"color: #DCDCAA\">AVG</span><span style=\"color: #D4D4D4\">(age) </span><span style=\"color: #569CD6\">AS</span><span style=\"color: #D4D4D4\"> avgage</span></span>\n<span class=\"line\"><span style=\"color: #569CD6\">FROM</span><span style=\"color: #D4D4D4\"> student</span></span>\n<span class=\"line\"><span style=\"color: #569CD6\">GROUP BY</span><span style=\"color: #D4D4D4\"> department</span></span>\n<span class=\"line\"><span style=\"color: #569CD6\">ORDER BY</span><span style=\"color: #D4D4D4\"> avgage;</span></span></code></pre></div><p>这里AS的意思是给AVG(age)起了个avgage别名。还可以使用HAVING对分组进行筛选，HAVING子句给出的条件只针对GROUP BY子句形成的分组起作用，也可以使用聚集函数。</p>\n<h3 id=\"联接查询\"><a href=\"#联接查询\" class=\"headerlink\" title=\"联接查询\"></a>联接查询</h3><p>如果查询的数据涉及两个或多个表，可以使用联接操作，称为联接查询。</p>\n<p><strong>联接条件</strong>决定了两个表中哪些行是匹配的，以联接结果中出现哪些列</p>\n<p><strong>联接类型</strong>是按照对悬浮行的不同处理方式来分的，即内联接，左外联接，右外联接，全外联接。</p>\n<p>在写多表联接查询语句的时候，如果查询涉及多个表，最简单直接的方法就是在FROM后面依次写上这些表名，并以逗号或CROSS JOIN分隔。FROM子句的结果表就是这些表的笛卡尔积，结果表包含所有这些表的所有列。如果两个表中有同名列，在列名前加上表名作前缀，表明该列的来源表。根据查询需要，还可通过WHERE子句对笛卡尔积结果表施加选择操作，以撷取那些符合查询条件的行。</p>\n<p>如果是自然联接，则用NATURAL JOIN来分割表名。</p>\n<p>如果是属性联接，用到的是JOIN USING语法</p>\n<div class=\"language-sql\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">sql</span><pre class=\"shiki dark-plus\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #569CD6\">SELECT</span><span style=\"color: #D4D4D4\"> *</span></span>\n<span class=\"line\"><span style=\"color: #569CD6\">FROM</span><span style=\"color: #D4D4D4\"> math_exam </span><span style=\"color: #569CD6\">JOIN</span><span style=\"color: #D4D4D4\"> english_exam </span><span style=\"color: #569CD6\">USING</span><span style=\"color: #D4D4D4\">(id);</span></span></code></pre></div><p>如果是条件联接，用到的是JOIN ON语法</p>\n<div class=\"language-sql\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">sql</span><pre class=\"shiki dark-plus\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #569CD6\">SELECT</span><span style=\"color: #D4D4D4\"> *</span></span>\n<span class=\"line\"><span style=\"color: #569CD6\">FROM</span><span style=\"color: #D4D4D4\"> math_exam </span><span style=\"color: #569CD6\">JOIN</span><span style=\"color: #D4D4D4\"> english_exam </span><span style=\"color: #569CD6\">ON</span><span style=\"color: #D4D4D4\"> math_exam.id=english_exam.id;</span></span></code></pre></div><p>内联接用INNER而外联接用OUTER<br>默认为INNER<br>LEFT、RIGHT、FULL均隐含外联接  </p>\n<h3 id=\"嵌套查询\"><a href=\"#嵌套查询\" class=\"headerlink\" title=\"嵌套查询\"></a>嵌套查询</h3><p>一个SELECT-FROM-WHERE语句称为一个查询块，将一个查询块嵌套在另一个查询块的SELECT FROM、WHERE、GROUP BY、HAVING、ORDER BY、LIMIT、OFFSET或WITH子句中的查询称为嵌套查询。</p>\n<p><strong>表式嵌套</strong>：嵌套查询的结果是一个表，可以在外层查询中使用。</p>\n<div class=\"language-sql\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">sql</span><pre class=\"shiki dark-plus\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #569CD6\">WITH</span><span style=\"color: #D4D4D4\"> avgach(eeid,avgachieve)</span><span style=\"color: #569CD6\">AS</span><span style=\"color: #D4D4D4\">(</span></span>\n<span class=\"line\"><span style=\"color: #D4D4D4\">  </span><span style=\"color: #569CD6\">SELECT</span><span style=\"color: #D4D4D4\"> eeid,</span><span style=\"color: #DCDCAA\">AVG</span><span style=\"color: #D4D4D4\">(achieve)</span><span style=\"color: #569CD6\">FROM</span><span style=\"color: #D4D4D4\"> eeexam</span></span>\n<span class=\"line\"><span style=\"color: #D4D4D4\">  </span><span style=\"color: #569CD6\">GROUP BY</span><span style=\"color: #D4D4D4\"> eeid</span></span>\n<span class=\"line\"><span style=\"color: #D4D4D4\">  )</span></span>\n<span class=\"line\"><span style=\"color: #569CD6\">SELECT</span><span style=\"color: #D4D4D4\"> </span><span style=\"color: #DCDCAA\">COUNT</span><span style=\"color: #D4D4D4\">(*)</span></span>\n<span class=\"line\"><span style=\"color: #569CD6\">FROM</span><span style=\"color: #D4D4D4\"> avgach</span></span>\n<span class=\"line\"><span style=\"color: #569CD6\">WHERE</span><span style=\"color: #D4D4D4\"> avgachieve&gt;=</span><span style=\"color: #B5CEA8\">80</span><span style=\"color: #D4D4D4\">;</span></span></code></pre></div><div class=\"language-sql\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">sql</span><pre class=\"shiki dark-plus\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #569CD6\">SELECT</span><span style=\"color: #D4D4D4\"> </span><span style=\"color: #DCDCAA\">COUNT</span><span style=\"color: #D4D4D4\">(*)</span></span>\n<span class=\"line\"><span style=\"color: #569CD6\">FROM</span><span style=\"color: #D4D4D4\"> ( </span><span style=\"color: #569CD6\">SELECT</span><span style=\"color: #D4D4D4\"> eeid,</span><span style=\"color: #DCDCAA\">avg</span><span style=\"color: #D4D4D4\">(achieve)</span></span>\n<span class=\"line\"><span style=\"color: #D4D4D4\">  </span><span style=\"color: #569CD6\">FROM</span><span style=\"color: #D4D4D4\"> eeexam</span></span>\n<span class=\"line\"><span style=\"color: #D4D4D4\">  </span><span style=\"color: #569CD6\">GROUP BY</span><span style=\"color: #D4D4D4\"> eeid</span></span>\n<span class=\"line\"><span style=\"color: #D4D4D4\">  )</span><span style=\"color: #569CD6\">AS</span><span style=\"color: #D4D4D4\"> avgach (eeid,avgachieve)</span></span>\n<span class=\"line\"><span style=\"color: #569CD6\">WHERE</span><span style=\"color: #D4D4D4\"> avgachieve&gt;=</span><span style=\"color: #B5CEA8\">80</span><span style=\"color: #D4D4D4\">;</span></span>\n<span class=\"line\"></span></code></pre></div><p>注意：WITH子句只在包含它自己的查询语句中有效,WITH子句中的AS不能省略。</p>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p><strong>相关嵌套查询</strong>：嵌套查询的结果是一个表，可以在外层查询中使用。外层查询中的表达式中包含内层查询的结果。</p></blockquote>\n<p><strong>集合嵌套</strong>：嵌套查询的结果是一个集合，可以在外层查询中使用。</p>\n<div class=\"language-sql\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">sql</span><pre class=\"shiki dark-plus\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #569CD6\">SELECT</span><span style=\"color: #D4D4D4\"> eid,ename</span></span>\n<span class=\"line\"><span style=\"color: #569CD6\">FROM</span><span style=\"color: #D4D4D4\"> exampaper</span></span>\n<span class=\"line\"><span style=\"color: #569CD6\">WHERE</span><span style=\"color: #D4D4D4\"> eid </span><span style=\"color: #569CD6\">IN</span></span>\n<span class=\"line\"><span style=\"color: #D4D4D4\">  (</span><span style=\"color: #569CD6\">SELECT</span><span style=\"color: #D4D4D4\"> eid</span></span>\n<span class=\"line\"><span style=\"color: #D4D4D4\">  </span><span style=\"color: #569CD6\">FROM</span><span style=\"color: #D4D4D4\"> eeexam</span></span>\n<span class=\"line\"><span style=\"color: #D4D4D4\">  </span><span style=\"color: #569CD6\">WHERE</span><span style=\"color: #D4D4D4\"> eeid=</span><span style=\"color: #CE9178\">'218811011013'</span><span style=\"color: #D4D4D4\">);</span></span></code></pre></div><div class=\"language-sql\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">sql</span><pre class=\"shiki dark-plus\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #569CD6\">SELECT</span><span style=\"color: #D4D4D4\"> *</span></span>\n<span class=\"line\"><span style=\"color: #569CD6\">FROM</span><span style=\"color: #D4D4D4\"> examinee</span></span>\n<span class=\"line\"><span style=\"color: #569CD6\">WHERE</span><span style=\"color: #D4D4D4\"> </span><span style=\"color: #569CD6\">EXISTS</span></span>\n<span class=\"line\"><span style=\"color: #D4D4D4\">  (</span><span style=\"color: #569CD6\">SELECT</span><span style=\"color: #D4D4D4\">*</span></span>\n<span class=\"line\"><span style=\"color: #D4D4D4\">  </span><span style=\"color: #569CD6\">FROM</span><span style=\"color: #D4D4D4\"> eeexam</span></span>\n<span class=\"line\"><span style=\"color: #D4D4D4\">  </span><span style=\"color: #569CD6\">WHERE</span><span style=\"color: #D4D4D4\"> eeid=examinee.eeid </span><span style=\"color: #569CD6\">AND</span><span style=\"color: #D4D4D4\"> eid= </span><span style=\"color: #CE9178\">'0205000002'</span><span style=\"color: #D4D4D4\">);</span></span></code></pre></div><blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p><strong>不相关嵌套查询</strong>：嵌套查询的结果是一个集合，可以在外层查询中使用。外层查询中的表达式中不包含内层查询的结果。</p></blockquote>\n<p><strong>标量式嵌套</strong>：嵌套查询的结果是一个标量，可以在外层查询中使用。</p>\n<div class=\"language-sql\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">sql</span><pre class=\"shiki dark-plus\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #569CD6\">SELECT</span><span style=\"color: #D4D4D4\"> dname,</span></span>\n<span class=\"line\"><span style=\"color: #D4D4D4\">  (</span><span style=\"color: #569CD6\">SELECT</span><span style=\"color: #D4D4D4\"> </span><span style=\"color: #DCDCAA\">COUNT</span><span style=\"color: #D4D4D4\">(*)</span></span>\n<span class=\"line\"><span style=\"color: #D4D4D4\">  </span><span style=\"color: #569CD6\">FROM</span><span style=\"color: #D4D4D4\"> examiner</span></span>\n<span class=\"line\"><span style=\"color: #D4D4D4\">  </span><span style=\"color: #569CD6\">WHERE</span><span style=\"color: #D4D4D4\"> examiner.erdepa=department.dname)</span></span>\n<span class=\"line\"><span style=\"color: #569CD6\">FROM</span><span style=\"color: #D4D4D4\"> department;</span></span></code></pre></div><div class=\"language-sql\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">sql</span><pre class=\"shiki dark-plus\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #569CD6\">SELECT</span><span style=\"color: #D4D4D4\"> eeid，eename</span></span>\n<span class=\"line\"><span style=\"color: #569CD6\">FROM</span><span style=\"color: #D4D4D4\"> examineeWHERE eedepa =</span></span>\n<span class=\"line\"><span style=\"color: #D4D4D4\">  (</span><span style=\"color: #569CD6\">SELECT</span><span style=\"color: #D4D4D4\"> eedepa</span></span>\n<span class=\"line\"><span style=\"color: #D4D4D4\">  </span><span style=\"color: #569CD6\">FROM</span><span style=\"color: #D4D4D4\"> examinee</span></span>\n<span class=\"line\"><span style=\"color: #D4D4D4\">  </span><span style=\"color: #569CD6\">WHERE</span><span style=\"color: #D4D4D4\"> eeid=</span><span style=\"color: #CE9178\">'218811011028'</span><span style=\"color: #D4D4D4\">);</span></span></code></pre></div><div class=\"language-sql\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">sql</span><pre class=\"shiki dark-plus\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #569CD6\">SELECT</span><span style=\"color: #D4D4D4\"> (</span></span>\n<span class=\"line\"><span style=\"color: #D4D4D4\">  </span><span style=\"color: #569CD6\">SELECT</span><span style=\"color: #D4D4D4\"> eedepa</span></span>\n<span class=\"line\"><span style=\"color: #D4D4D4\">  </span><span style=\"color: #569CD6\">FROM</span><span style=\"color: #D4D4D4\"> examinee</span></span>\n<span class=\"line\"><span style=\"color: #D4D4D4\">  </span><span style=\"color: #569CD6\">WHERE</span><span style=\"color: #D4D4D4\"> eeexam.eeid=examinee.eeid) ,</span></span>\n<span class=\"line\"><span style=\"color: #D4D4D4\">  </span><span style=\"color: #DCDCAA\">avg</span><span style=\"color: #D4D4D4\">(achieve)</span></span>\n<span class=\"line\"><span style=\"color: #569CD6\">FROM</span><span style=\"color: #D4D4D4\"> eeexam</span></span>\n<span class=\"line\"><span style=\"color: #569CD6\">GROUP BY</span><span style=\"color: #D4D4D4\">(</span></span>\n<span class=\"line\"><span style=\"color: #D4D4D4\">  </span><span style=\"color: #569CD6\">SELECT</span><span style=\"color: #D4D4D4\"> eedepa</span></span>\n<span class=\"line\"><span style=\"color: #D4D4D4\">  </span><span style=\"color: #569CD6\">FROM</span><span style=\"color: #D4D4D4\"> examinee</span></span>\n<span class=\"line\"><span style=\"color: #D4D4D4\">  </span><span style=\"color: #569CD6\">WHERE</span><span style=\"color: #D4D4D4\"> eeexam.eeid=examinee.eeid);</span></span></code></pre></div><blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>查询块可以出现在任何表名可以出现的地方，也可以出现在集合可以出现的地方，如果能确定查询块只返回单行单列的单个值，查询块可以出现在单个属性名、单个表达式、单个常量 可以出现的地方。</p></blockquote>\n","feature":true,"text":"数据的定义与操作SQL概述关系数据库的标准语言是 Structured Query Language，全称的翻译成中文就是结构化查询语言，简称SQL。虽然SQL...","permalink":"/post/数据库系统原理（二）","photos":[],"count_time":{"symbolsCount":"5.4k","symbolsTime":"5 mins."},"categories":[{"name":"数据库","slug":"数据库","count":2,"path":"api/categories/数据库.json"}],"tags":[{"name":"数据库","slug":"数据库","count":2,"path":"api/tags/数据库.json"},{"name":"学习笔记","slug":"学习笔记","count":2,"path":"api/tags/学习笔记.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E6%95%B0%E6%8D%AE%E7%9A%84%E5%AE%9A%E4%B9%89%E4%B8%8E%E6%93%8D%E4%BD%9C\"><span class=\"toc-text\">数据的定义与操作</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#SQL%E6%A6%82%E8%BF%B0\"><span class=\"toc-text\">SQL概述</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E6%95%B0%E6%8D%AE%E7%9A%84%E5%AE%9A%E4%B9%89%E4%BB%A5%E5%8F%8A%E4%BF%AE%E6%94%B9\"><span class=\"toc-text\">数据的定义以及修改</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E7%AE%80%E5%8D%95%E6%9F%A5%E8%AF%A2\"><span class=\"toc-text\">简单查询</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E8%81%94%E6%8E%A5%E6%9F%A5%E8%AF%A2\"><span class=\"toc-text\">联接查询</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%B5%8C%E5%A5%97%E6%9F%A5%E8%AF%A2\"><span class=\"toc-text\">嵌套查询</span></a></li></ol></li></ol>","author":{"name":"Ac-Accelerator","slug":"blog-author","avatar":"/img/avatar.jpg","link":"/","description":"一位计算机技术爱好者，大学在读，目前正在学习C++、Python、Java和计算机系统以及计算机视觉深度学习等相关知识，欢迎交流","socials":{"github":"https://github.com/Ac-Accelerator","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/qq_31702515?spm=1000.2115.3001.5343","juejin":"","customs":{"qq":{"icon":"/svg/QQ.svg","link":"http://tool.gljlw.com/qq/?qq=2583832841"}}}},"mapped":true,"hidden":false,"prev_post":{"title":"8086微机汇编语言","uid":"59fff721b35c430dcc2003c20536d30b","slug":"8086微机汇编语言","date":"2023-04-16T10:25:35.000Z","updated":"2023-06-06T06:53:13.516Z","comments":true,"path":"api/articles/8086微机汇编语言.json","keywords":"C++,Pyhton,Java,算法","cover":"/img/huibian.jpeg","text":"在学校学习了汇编语言一课程，但是由于汇编指令繁多，而且在互联网上没有找到满足我要求的资料。同时书上的知识也比较分散，不好索引。所以我打算自己整理一份资料，方便自...","permalink":"/post/8086微机汇编语言","photos":[],"count_time":{"symbolsCount":"7.7k","symbolsTime":"7 mins."},"categories":[{"name":"汇编","slug":"汇编","count":1,"path":"api/categories/汇编.json"}],"tags":[{"name":"汇编","slug":"汇编","count":1,"path":"api/tags/汇编.json"}],"author":{"name":"Ac-Accelerator","slug":"blog-author","avatar":"/img/avatar.jpg","link":"/","description":"一位计算机技术爱好者，大学在读，目前正在学习C++、Python、Java和计算机系统以及计算机视觉深度学习等相关知识，欢迎交流","socials":{"github":"https://github.com/Ac-Accelerator","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/qq_31702515?spm=1000.2115.3001.5343","juejin":"","customs":{"qq":{"icon":"/svg/QQ.svg","link":"http://tool.gljlw.com/qq/?qq=2583832841"}}}},"feature":true},"next_post":{"title":"数据库系统原理（一）","uid":"13bf866f8a267e47702ed2383b6aca22","slug":"数据库系统原理（一）","date":"2023-03-28T10:56:00.000Z","updated":"2023-09-25T17:40:11.345Z","comments":true,"path":"api/articles/数据库系统原理（一）.json","keywords":"C++,Pyhton,Java,算法","cover":"/img/db.jpeg","text":"绪论数据库是什么广义定义：指包含关于某单位、机构、部门，或是某领域、业务主题，或是某对象的信息、互相关联的大量数据的集合。 狭义定义：特指用专门通用软件管理，长...","permalink":"/post/数据库系统原理（一）","photos":[],"count_time":{"symbolsCount":"4.3k","symbolsTime":"4 mins."},"categories":[{"name":"数据库","slug":"数据库","count":2,"path":"api/categories/数据库.json"}],"tags":[{"name":"数据库","slug":"数据库","count":2,"path":"api/tags/数据库.json"},{"name":"学习笔记","slug":"学习笔记","count":2,"path":"api/tags/学习笔记.json"}],"author":{"name":"Ac-Accelerator","slug":"blog-author","avatar":"/img/avatar.jpg","link":"/","description":"一位计算机技术爱好者，大学在读，目前正在学习C++、Python、Java和计算机系统以及计算机视觉深度学习等相关知识，欢迎交流","socials":{"github":"https://github.com/Ac-Accelerator","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/qq_31702515?spm=1000.2115.3001.5343","juejin":"","customs":{"qq":{"icon":"/svg/QQ.svg","link":"http://tool.gljlw.com/qq/?qq=2583832841"}}}},"feature":true}}