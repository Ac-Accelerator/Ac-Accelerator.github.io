{"title":"Python小应用——删除答案","uid":"298601bdff7402f7c70804cf98e17980","slug":"Python小应用——删除答案","date":"2022-06-01T09:22:00.000Z","updated":"2023-07-13T18:11:57.602Z","comments":true,"path":"api/articles/Python小应用——删除答案.json","keywords":"C++,Pyhton,Java,算法","cover":"/img/python-make.jpeg","content":"<h3 id=\"初衷\"><a href=\"#初衷\" class=\"headerlink\" title=\"初衷\"></a>初衷</h3><p>有时候呢，考试前学校会发一些docx文档型的资料。这些资料类似于填了答案的填空题，方便我们快速复习、查找重点。然而一旦我们想要测试一下自己是不是真正记住了，就会想这如何不去看“答案”而把问题回答出来，就像做真正的填空题一样。你可以用手指蒙住，也可以手动将他们全部删除。  </p>\n<img src=\"/img/p2.png\" title=\"类似于这样的资料\">\n\n<p>但是就我而言，手指蒙住根本抵挡不了看答案诱惑。我又是个懒鬼，不想一个一个删除（其实我还想通过看下划线的长短，或多或少的记起答案）。虽然这次一个一个删除省事一些，可是一想到以后可能还会遇到这种情况，我就忍不住偷懒了，加上我对编程感兴趣，索性用python来做一个小脚本。</p>\n<h3 id=\"准备工作\"><a href=\"#准备工作\" class=\"headerlink\" title=\"准备工作\"></a>准备工作</h3><p>安装python-docx库。</p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki dark-plus\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #D4D4D4\">pip install python-docx</span></span></code></pre></div><p><a href=\"https://python-docx.readthedocs.io/en/latest/\">python-docx的官方使用文档</a>  </p>\n<p>可以参考B站的一个<a href=\"https://www.bilibili.com/video/BV1FC4y1Y7QC\">视频</a>。<br><a href=\"https://www.bilibili.com/video/BV1FC4y1Y7QC?p=14&t=39.5\"><img src=\"/img/p3.png\" title=\"docx库的结构\"></a><br>稍微了解一下这个库的功能结构，我们便可以对docx文档进行任何想进行的操作。</p>\n<h3 id=\"实践操作\"><a href=\"#实践操作\" class=\"headerlink\" title=\"实践操作\"></a>实践操作</h3><p>下面贴上代码和注释：</p>\n<div class=\"language-python\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">python</span><pre class=\"shiki dark-plus\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #C586C0\">from</span><span style=\"color: #D4D4D4\"> docx </span><span style=\"color: #C586C0\">import</span><span style=\"color: #D4D4D4\"> Document</span></span>\n<span class=\"line\"><span style=\"color: #C586C0\">import</span><span style=\"color: #D4D4D4\"> docx</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #6A9955\">#用已存在的文件'知识汇总.docx'创建一个Document对象，赋值给变量doc。这里可以是文件的绝对路径也可以是相对路径。</span></span>\n<span class=\"line\"><span style=\"color: #D4D4D4\">doc=Document(</span><span style=\"color: #CE9178\">'知识汇总.docx'</span><span style=\"color: #D4D4D4\">)</span></span>\n<span class=\"line\"><span style=\"color: #DCDCAA\">print</span><span style=\"color: #D4D4D4\">(</span><span style=\"color: #CE9178\">\"opened successfully,start processing\"</span><span style=\"color: #D4D4D4\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #6A9955\">#文章是由一个一个段落组成的，我们遍历所有段落</span></span>\n<span class=\"line\"><span style=\"color: #C586C0\">for</span><span style=\"color: #D4D4D4\"> p </span><span style=\"color: #C586C0\">in</span><span style=\"color: #D4D4D4\"> doc.paragraphs:</span></span>\n<span class=\"line\"><span style=\"color: #D4D4D4\">    </span><span style=\"color: #6A9955\">#段落是由块组成的，我们遍历文章里的每一个块。</span></span>\n<span class=\"line\"><span style=\"color: #D4D4D4\">    </span><span style=\"color: #C586C0\">for</span><span style=\"color: #D4D4D4\"> block </span><span style=\"color: #C586C0\">in</span><span style=\"color: #D4D4D4\"> p.runs:</span></span>\n<span class=\"line\"><span style=\"color: #D4D4D4\">        </span><span style=\"color: #6A9955\">#我这里是希望找到有下划线格式的块进行操作。你可以改变条件或者操作达到你想要的效果。</span></span>\n<span class=\"line\"><span style=\"color: #D4D4D4\">        </span><span style=\"color: #C586C0\">if</span><span style=\"color: #D4D4D4\">(block.font.underline):</span></span>\n<span class=\"line\"><span style=\"color: #D4D4D4\">            </span><span style=\"color: #6A9955\">#替换</span></span>\n<span class=\"line\"><span style=\"color: #D4D4D4\">            block.text=</span><span style=\"color: #CE9178\">'  '</span><span style=\"color: #D4D4D4\">*</span><span style=\"color: #DCDCAA\">len</span><span style=\"color: #D4D4D4\">(block.text)</span></span>\n<span class=\"line\"><span style=\"color: #DCDCAA\">print</span><span style=\"color: #D4D4D4\">(</span><span style=\"color: #CE9178\">'changed successfully'</span><span style=\"color: #D4D4D4\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #6A9955\"># doc.save('知识汇总.docx')#直接覆盖</span></span>\n<span class=\"line\"><span style=\"color: #D4D4D4\">doc.save(</span><span style=\"color: #CE9178\">'知识汇总(无答案版).docx'</span><span style=\"color: #D4D4D4\">)</span><span style=\"color: #6A9955\">#保存到新的文件</span></span>\n<span class=\"line\"><span style=\"color: #DCDCAA\">print</span><span style=\"color: #D4D4D4\">(</span><span style=\"color: #CE9178\">\"saved successfully\"</span><span style=\"color: #D4D4D4\">)</span></span></code></pre></div><p><strong>效果是这样啦</strong><br><img src=\"/img/p4.png\" title=\"效果图\"></p>\n","feature":true,"text":"初衷有时候呢，考试前学校会发一些docx文档型的资料。这些资料类似于填了答案的填空题，方便我们快速复习、查找重点。然而一旦我们想要测试一下自己是不是真正记住了，...","permalink":"/post/Python小应用——删除答案","photos":[],"count_time":{"symbolsCount":969,"symbolsTime":"1 mins."},"categories":[{"name":"Python","slug":"Python","count":1,"path":"api/categories/Python.json"}],"tags":[{"name":"python-docx","slug":"python-docx","count":1,"path":"api/tags/python-docx.json"},{"name":"docx","slug":"docx","count":1,"path":"api/tags/docx.json"},{"name":"Python","slug":"Python","count":1,"path":"api/tags/Python.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%88%9D%E8%A1%B7\"><span class=\"toc-text\">初衷</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%87%86%E5%A4%87%E5%B7%A5%E4%BD%9C\"><span class=\"toc-text\">准备工作</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%AE%9E%E8%B7%B5%E6%93%8D%E4%BD%9C\"><span class=\"toc-text\">实践操作</span></a></li></ol>","author":{"name":"Ac-Accelerator","slug":"blog-author","avatar":"/img/avatar.jpg","link":"/","description":"一位计算机技术爱好者，大学在读，目前正在学习C++、Python、Java和计算机系统以及计算机视觉深度学习等相关知识，欢迎交流","socials":{"github":"https://github.com/Ac-Accelerator","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/qq_31702515?spm=1000.2115.3001.5343","juejin":"","customs":{"bilibili":{"icon":"/svg/bilibili.svg","link":"https://space.bilibili.com/74120250?spm_id_from=333.1007.0.0"},"rss":{"icon":"/svg/rss.svg","link":"atom.xml"},"qq":{"icon":"/svg/QQ.svg","link":"http://tool.gljlw.com/qq/?qq=2583832841"}}}},"mapped":true,"hidden":false,"prev_post":{"title":"强化学习","uid":"4d1e3a4a4afff0b0d31e07df9ad79915","slug":"强化学习","date":"2022-07-14T13:23:00.000Z","updated":"2023-09-25T17:25:04.084Z","comments":true,"path":"api/articles/强化学习.json","keywords":"C++,Pyhton,Java,算法","cover":"/img/ai2.jpeg","text":"回顾监督学习： 学习一个模型，使得其能正确的将数据X映射到标签Y无监督学习 学习数据中潜在的结构以及信息 强化学习的概念强化学习主要由两个对象组成：Enviro...","permalink":"/post/强化学习","photos":[],"count_time":{"symbolsCount":"2.7k","symbolsTime":"2 mins."},"categories":[{"name":"人工智能","slug":"人工智能","count":4,"path":"api/categories/人工智能.json"}],"tags":[{"name":"强化学习","slug":"强化学习","count":1,"path":"api/tags/强化学习.json"}],"author":{"name":"Ac-Accelerator","slug":"blog-author","avatar":"/img/avatar.jpg","link":"/","description":"一位计算机技术爱好者，大学在读，目前正在学习C++、Python、Java和计算机系统以及计算机视觉深度学习等相关知识，欢迎交流","socials":{"github":"https://github.com/Ac-Accelerator","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/qq_31702515?spm=1000.2115.3001.5343","juejin":"","customs":{"bilibili":{"icon":"/svg/bilibili.svg","link":"https://space.bilibili.com/74120250?spm_id_from=333.1007.0.0"},"rss":{"icon":"/svg/rss.svg","link":"atom.xml"},"qq":{"icon":"/svg/QQ.svg","link":"http://tool.gljlw.com/qq/?qq=2583832841"}}}},"feature":true},"next_post":{"title":"计算机网络(四)","uid":"3adc7cb84d4ac3fb8fab9c8bd90e7a93","slug":"计算机网络-四","date":"2022-05-30T14:18:00.000Z","updated":"2023-07-13T18:14:08.291Z","comments":true,"path":"api/articles/计算机网络-四.json","keywords":"C++,Pyhton,Java,算法","cover":"/img/network4.jpeg","text":"传输层只有主机才有的层次 功能 传输层提供进程和进程之间的逻辑通信 分用和复用。 对收到的报文进行差错检测。 TCP和UDP。 复用:应用层所有的应用进程都可以...","permalink":"/post/计算机网络-四","photos":[],"count_time":{"symbolsCount":"5.2k","symbolsTime":"5 mins."},"categories":[{"name":"网络","slug":"网络","count":4,"path":"api/categories/网络.json"}],"tags":[{"name":"网络","slug":"网络","count":4,"path":"api/tags/网络.json"},{"name":"传输层","slug":"传输层","count":1,"path":"api/tags/传输层.json"},{"name":"应用层","slug":"应用层","count":1,"path":"api/tags/应用层.json"}],"author":{"name":"Ac-Accelerator","slug":"blog-author","avatar":"/img/avatar.jpg","link":"/","description":"一位计算机技术爱好者，大学在读，目前正在学习C++、Python、Java和计算机系统以及计算机视觉深度学习等相关知识，欢迎交流","socials":{"github":"https://github.com/Ac-Accelerator","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/qq_31702515?spm=1000.2115.3001.5343","juejin":"","customs":{"bilibili":{"icon":"/svg/bilibili.svg","link":"https://space.bilibili.com/74120250?spm_id_from=333.1007.0.0"},"rss":{"icon":"/svg/rss.svg","link":"atom.xml"},"qq":{"icon":"/svg/QQ.svg","link":"http://tool.gljlw.com/qq/?qq=2583832841"}}}},"feature":true}}